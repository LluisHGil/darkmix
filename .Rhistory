param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0);
for(j in 1:iter){
print(j)
ocf <- optim(param, model.lik, param2=param2, model=mixture.model, clust=clust, quad=quad);
param <- ocf$par;
-model.lik(param, param2, mixture.model, clust, quad)
# Further model refinement. Freezing
param <- mask.freeze(param, param2, mask.adjust_positions(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
param <- mask.freeze(param, param2, mask.adjust_radii(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
param <- mask.freeze(param, param2, mask.adjust_sersic(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
param <- mask.freeze(param, param2, mask.adjust_mix(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
ocf <- optim(param, model.lik, param2=param2, model=mixture.model, clust=clust, quad=quad);
param <- ocf$par;
-model.lik(param, param2, mixture.model, clust, quad)
#param2profile(param)
AIC.BIC(param, param2, clust, quad)
}
param2profile(param)
param13
AIC.BIC(param, param2, clust, quad)
param12 <- c(
33.49000,178.9100,99.73000,2.0749046,29.999596
,36.69000,192.3900,98.82000,0.8746156,2.537203,0.9507433
,39.54000,174.2700,97.52000,1.6259367,29.999999,-0.3413425
,26.04000,189.4000,98.93000,1.9683559,29.999999,-0.1339818
,20.42000,192.7700,100.89000,1.6110233,29.999980,-0.5442721
,38.67000,193.9300,96.25000,1.1872207,3.140976,0.1280503
,37.40000,175.3500,99.49000,7.5081201,29.999990,-3.0316632
,33.09000,190.3500,99.44000,1.8205880,3.338316,-1.1378126
,32.82000,185.5300,100.04000,3.2523657,29.99990,-1.7557535
,25.12000,181.9200,95.26000,3.8200717,29.999998,-1.9367203
,30.50000,188.3483,98.65151,2.2462170,29.999967,-2.3140624
,30.80302,187.4392,98.50000,1.4794865,29.997772,-2.0486636
,30,187,98,1,29,-4
,-2.064358)
param2profile(param12)
AIC.BIC(param12, param2, clust, quad)
param13 <- param12
k <- 13
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param13, param2, clust, quad)
param2profile(param13)
param12 <- c(
33.49000,178.9100,99.73000,2.0749046,29.999596
,36.69000,192.3900,98.82000,0.8746156,2.537203,0.9507433
,39.54000,174.2700,97.52000,1.6259367,29.999999,-0.3413425
,26.04000,189.4000,98.93000,1.9683559,29.999999,-0.1339818
,20.42000,192.7700,100.89000,1.6110233,29.999980,-0.5442721
,38.67000,193.9300,96.25000,1.1872207,3.140976,0.1280503
,37.40000,175.3500,99.49000,7.5081201,29.999990,-3.0316632
,33.09000,190.3500,99.44000,1.8205880,3.338316,-1.1378126
,32.82000,185.5300,100.04000,3.2523657,29.99990,-1.7557535
,25.12000,181.9200,95.26000,3.8200717,29.999998,-1.9367203
,30.50000,188.3483,98.65151,2.2462170,29.999967,-2.3140624
,30.80302,187.4392,98.50000,1.4794865,29.997772,-2.0486636
,30,187,98,1,29,-40
,-2.064358)
k <- 13
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param13, param2, clust, quad)
param14 <- c(
33.49000,178.9100,99.73000,2.0749046,29.999596
,36.69000,192.3900,98.82000,0.8746156,2.537203,0.9507433
,39.54000,174.2700,97.52000,1.6259367,29.999999,-0.3413425
,26.04000,189.4000,98.93000,1.9683559,29.999999,-0.1339818
,20.42000,192.7700,100.89000,1.6110233,29.999980,-0.5442721
,38.67000,193.9300,96.25000,1.1872207,3.140976,0.1280503
,37.40000,175.3500,99.49000,7.5081201,29.999990,-3.0316632
,33.09000,190.3500,99.44000,1.8205880,3.338316,-1.1378126
,32.82000,185.5300,100.04000,3.2523657,29.99990,-1.7557535
,25.12000,181.9200,95.26000,3.8200717,29.999998,-1.9367203
,30.50000,188.3483,98.65151,2.2462170,29.999967,-2.3140624
,30.80302,187.4392,98.50000,1.4794865,29.997772,-2.0486636
,30,187,98,1,29,-40,30,187,98,1,29,-40
,-2.064358)
param13 <- c(
33.49000,178.9100,99.73000,2.0749046,29.999596
,36.69000,192.3900,98.82000,0.8746156,2.537203,0.9507433
,39.54000,174.2700,97.52000,1.6259367,29.999999,-0.3413425
,26.04000,189.4000,98.93000,1.9683559,29.999999,-0.1339818
,20.42000,192.7700,100.89000,1.6110233,29.999980,-0.5442721
,38.67000,193.9300,96.25000,1.1872207,3.140976,0.1280503
,37.40000,175.3500,99.49000,7.5081201,29.999990,-3.0316632
,33.09000,190.3500,99.44000,1.8205880,3.338316,-1.1378126
,32.82000,185.5300,100.04000,3.2523657,29.99990,-1.7557535
,25.12000,181.9200,95.26000,3.8200717,29.999998,-1.9367203
,30.50000,188.3483,98.65151,2.2462170,29.999967,-2.3140624
,30.80302,187.4392,98.50000,1.4794865,29.997772,-2.0486636
,30,187,98,1,29,-40
,-2.064358)
k <- 13
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param13, param2, clust, quad)
k <- 14
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param14, param2, clust, quad)
best.fit9 <- c(
20.4115009, 192.7209015,	 100.8093033,	0.8065428,	11.3128125,
25.1077021, 181.8583985,	 95.2821064,	0.8191246,	5.1012452,  -0.2379957,
26.01683120,189.32470619,98.86227784,	1.50531608,	3.69431746, 0.02712207,
32.74719921,185.46240145,100.04940025,	0.63714689,	14.96737019,-0.07960618,
32.6889992, 189.9535981,	 99.0363006,	0.7704724,	28.9095360, -0.6551086,
33.4534340, 178.8260474,	 99.7111627,	1.5903144,	4.0705328,  0.1752253,
36.6528241, 192.3287519,	 98.7546448,	1.0676660,	4.3961080,  0.3608278,
38.57145463,193.89236657,96.16075744,	1.08805295,	3.18687751, -0.07136057
,39.4692399, 174.2195559,	 97.4242632,	1.3101977,	4.5570036,  -0.2467555,
-2.0570761)
param2profile(best.fit9)
param9 <- best.fit9
k <- 9
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param9, param2, clust, quad)
i <- 9
param <- param9
print(i)
k <- i
v <- 5 # x,y,z,re,n
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0);
#  cent <- centers(clust, h=0.3, ntile=c(25,25,7), k)
iter=5
for(j in 1:iter){
print(j)
ocf <- optim(param, model.lik, param2=param2, model=mixture.model, clust=clust, quad=quad);
param <- ocf$par;
-model.lik(param, param2, mixture.model, clust, quad)
# Further model refinement. Freezing
param <- mask.freeze(param, param2, mask.adjust_positions(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
param <- mask.freeze(param, param2, mask.adjust_radii(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
param <- mask.freeze(param, param2, mask.adjust_sersic(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
param <- mask.freeze(param, param2, mask.adjust_mix(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
ocf <- optim(param, model.lik, param2=param2, model=mixture.model, clust=clust, quad=quad);
param <- ocf$par;
-model.lik(param, param2, mixture.model, clust, quad)
param2profile(param)
AIC.BIC(param, param2, clust, quad)
}
getwd()
aic <- read.table('ML_AIC_BIC.txt')
aic <- read.table('ML_AIC_BIC')
aic <- read.table('ML_AIC_BIC')
aic <- read.table('ML_AIC_BIC.txt')
aic <- read.table('ML_AIC_BIC.txt')
aic
plot(aic[,c(1,3)])
aic <- read.table('ML_AIC_BIC.txt', header=TRUE)
plot(aic[,c(1,3)])
plot(aic[,1], -aic[,3])
dev.off()
plot(aic[,1], -aic[,3])
points(aic[,1], aic[,2])
points(aic[,1], aic[,2], type="b")
plot(aic[,1], -aic[,3], type="b")
points(aic[,1], aic[,2], type="b", col=2)
plot(aic[,1], -aic[,3], type="b", xlim=c(5,14))
plot(aic[,1], -aic[,3], type="b", xlim=c(5,14), ylim=c(900,3500))
plot(aic[,1], -aic[,3], type="b", xlim=c(5,14), ylim=c(900,3700))
points(aic[,1], aic[,2], type="b", col=2)
points(aic[,1], aic[,3], type="b", col=3)
points(aic[,1], -aic[,4], type="b", col=3)
best.fit9 <- c(
20.4115009, 192.7209015,	 100.8093033,	0.8065428,	11.3128125,
25.1077021, 181.8583985,	 95.2821064,	0.8191246,	5.1012452,  -0.2379957,
26.01683120,189.32470619,98.86227784,	1.50531608,	3.69431746, 0.02712207,
32.74719921,185.46240145,100.04940025,	0.63714689,	14.96737019,-0.07960618,
32.6889992, 189.9535981,	 99.0363006,	0.7704724,	28.9095360, -0.6551086,
33.4534340, 178.8260474,	 99.7111627,	1.5903144,	4.0705328,  0.1752253,
36.6528241, 192.3287519,	 98.7546448,	1.0676660,	4.3961080,  0.3608278,
38.57145463,193.89236657,96.16075744,	1.08805295,	3.18687751, -0.07136057
,39.4692399, 174.2195559,	 97.4242632,	1.3101977,	4.5570036,  -0.2467555,
-2.0570761)
best.fit8 <- c(
20.4115, 	192.7209, 	100.8093, 	0.7043904, 	3.863629,
25.08 ,		181.8445, 	95.1971, 	0.5704714, 	8.739893, 	-0.1770557,
26.00474, 	189.3456, 	98.87138, 	1.206142, 	2.603251, 	0.03119199,
32.7994, 	185.5033, 	100.0543, 	0.6381238, 	22.30211, 	-0.2567489,
33.45888, 	178.7999, 	99.70272,	1.151322, 	2.580908, 	0.3113691,
36.6614, 	192.3323, 	98.75494, 	0.8934608, 	3.187236, 	0.3417035,
38.59973, 	193.8401, 	96.17071, 	0.8481247, 	-2.258331, 	-0.06438882,
39.46937, 	174.2165, 	97.43567, 	1.068227, 	3.202133, 	-0.2851116,
-2.131754)
best.fit7 <- c(33.49064057,178.81823825,99.67297463,3.50675328,17.19864656,36.58717423,192.41395273,98.75807514,1.19973692,19.54102740,1.03018329,39.50470556,174.23329840,97.49335940,1.15731316,25.80417902,0.76932166,25.97954381,189.43264352,98.91216652,1.25347861,29.95355119,1.08576993,20.48780801,192.69552175,100.84900542,1.09716115,29.92893875,0.54914802,38.57085531,193.95975705,96.14788591,0.93637276,22.81280311,0.97947835,47.51026301,183.39151518,105.63535392,1.46679836,0.09135961,1.18440199,-1.11245379)
best.fit6 <- c(33.4922778,178.7986363,99.6374025,1.7764093,11.0413781,36.6465465,192.4226231,98.7433891,0.6958162,4.0928611,0.9438338,39.4714647,174.2871702,97.4884604,0.5068079,23.8376086,0.9617357,25.9833269,189.4876882,98.9307028,0.6716782,29.9954276,1.0303856,20.5144112,192.6262481,100.8967307,0.4479781,29.9997800,0.9084992,38.5415003,193.9679828,96.2248270,0.5300646,29.4606345,0.8219343,-1.8258571)
param6 <- best.fit6
param7 <- best.fit7
param8 <- best.fit8
param9 <- best.fit9
k <- 6
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param6, param2, clust, quad)
k <- 7
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param7, param2, clust, quad)
k <- 8
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param8, param2, clust, quad)
k <- 9
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param9, param2, clust, quad)
load("/Users/HurtadoGil/Documents/Estudi_treball/Tesi/MixtureDM/Outputs/ocf.rds")
best.fit8 <- ocf$par
best.fit8 <- c(
20.41150093,192.72090149,100.80930328,0.80654104,4.77689899,
25.12299919,181.83689880,95.30950165,0.67731033,23.88494319,-0.26583147,
26.01471713,189.33656430,98.86733155,1.21205689,2.69675479,0.18823123,
32.74720001,185.46240235,100.04940033,0.63714232,17.49706626,-0.07960418,
33.45556494,178.80472803,99.70399874,1.12322547,2.62114522,0.50479527,
36.66022507,192.33191300,98.75530868,0.86186248,3.23552243,0.54795481,
38.59889961,193.84173323,96.17147772,0.79259489,2.17559805,0.19793384,
39.46920101,174.21810206,97.43600954,1.04575160,3.23814313,-0.08953188,
-2.05707600)
param6 <- best.fit6
param7 <- best.fit7
param8 <- best.fit8
param9 <- best.fit9
k <- 6
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param6, param2, clust, quad)
k <- 7
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param7, param2, clust, quad)
k <- 8
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param8, param2, clust, quad)
k <- 9
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param9, param2, clust, quad)
aic <- read.table('ML_AIC_BIC.txt', header=TRUE)
plot(aic[,1], -aic[,3], type="b", xlim=c(5,14), ylim=c(900,3700))
points(aic[,1], aic[,2], type="b", col=2)
points(aic[,1], -aic[,4], type="b", col=3)
iter=3
i <- 7
param <- param7
print(i)
k <- i
v <- 5 # x,y,z,re,n
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0);
#  cent <- centers(clust, h=0.3, ntile=c(25,25,7), k)
for(j in 1:iter){
print(j)
ocf <- optim(param, model.lik, param2=param2, model=mixture.model, clust=clust, quad=quad);
param <- ocf$par;
-model.lik(param, param2, mixture.model, clust, quad)
# Further model refinement. Freezing
param <- mask.freeze(param, param2, mask.adjust_positions(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
param <- mask.freeze(param, param2, mask.adjust_radii(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
param <- mask.freeze(param, param2, mask.adjust_sersic(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
param <- mask.freeze(param, param2, mask.adjust_mix(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
ocf <- optim(param, model.lik, param2=param2, model=mixture.model, clust=clust, quad=quad);
param <- ocf$par;
-model.lik(param, param2, mixture.model, clust, quad)
param2profile(param)
AIC.BIC(param, param2, clust, quad)
}
AIC.BIC(param, param2, clust, quad)
k
for(j in 1:iter){
print(j)
ocf <- optim(param, model.lik, param2=param2, model=mixture.model, clust=clust, quad=quad);
param <- ocf$par;
-model.lik(param, param2, mixture.model, clust, quad)
# Further model refinement. Freezing
param <- mask.freeze(param, param2, mask.adjust_positions(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
param <- mask.freeze(param, param2, mask.adjust_radii(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
param <- mask.freeze(param, param2, mask.adjust_sersic(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
param <- mask.freeze(param, param2, mask.adjust_mix(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
ocf <- optim(param, model.lik, param2=param2, model=mixture.model, clust=clust, quad=quad);
param <- ocf$par;
-model.lik(param, param2, mixture.model, clust, quad)
param2profile(param)
AIC.BIC(param, param2, clust, quad)
}
AIC.BIC(param, param2, clust, quad)
k
arg = list(mar=c(0,0,0,0), clust=clust, col=2, pch=16, border=2, cex=0.5, lwd=2)
mixture.model(param, param2, output = NULL, action.draw, arg)
clust
aic <- read.table('ML_AIC_BIC.txt', header=TRUE)
aic
aic <- aic[-1,]
plot(aic[,1], -aic[,3], type="b", xlim=c(5,14), ylim=c(900,3700))
points(aic[,1], aic[,3], type="b", col=3)
points(aic[,1], -aic[,4], type="b", col=3)
aic
dev.off()
plot(aic[,1], -aic[,3], type="b", xlim=c(5,14), ylim=c(900,3700))
points(aic[,1], aic[,3], type="b", col=3)
points(aic[,1], -aic[,4], type="b", col=3)
plot(aic[,1], -aic[,3], type="b", ylim=c(900,3700))
points(aic[,1], aic[,3], type="b", col=3)
points(aic[,1], -aic[,4], type="b", col=3)
points(aic[,1], aic[,2], type="b", col=2)
plot(aic[,1], aic[,2], type="b", col=2)
plot(aic[,1], -aic[,3], type="b", ylim=c(900,3700))
points(aic[,1], aic[,2], type="b", col=2)
points(aic[,1], aic[,3], type="b", col=3)
points(aic[,1], -aic[,4], type="b", col=3)
plot(aic[,1], -aic[,3], type="b", ylim=c(800,3700))
points(aic[,1], aic[,2], type="b", col=2)
points(aic[,1], aic[,3], type="b", col=3)
points(aic[,1], -aic[,4], type="b", col=3)
max_val <- max(-aic[,3:4])
max_val
lines(c(4,14),c(max_val, max_val))
plot(aic[,1], -aic[,3], type="b", ylim=c(800,3700))
points(aic[,1], aic[,2], type="b", pch=2)
plot(aic[,1], -aic[,3], type="b", ylim=c(800,3700))
points(aic[,1], aic[,2], type="b", pch=2)
points(aic[,1], -aic[,4], type="b", pch=3)
plot(aic[,1], -aic[,3], type="b", ylim=c(800,3700), pch=2)
points(aic[,1], aic[,2], type="b", pch=3)
points(aic[,1], -aic[,4], type="b", pch=1)
plot(aic[,1], -aic[,3], type="b", ylim=c(800,3700), pch=2)
points(aic[,1], aic[,2], type="b", pch=1)
points(aic[,1], -aic[,4], type="b", pch=3)
plot(aic[,1], -aic[,3], type="b", ylim=c(800,3700), pch=1)
points(aic[,1], aic[,2], type="b", pch=2)
points(aic[,1], -aic[,4], type="b", pch=3)
plot(aic[,1], -aic[,3], type="b", ylim=c(800,3700), pch=1)
points(aic[,1], -aic[,4], type="b", pch=3)
points(aic[,1], aic[,2], type="b", pch=2)
plot(aic[,1], -aic[,3], type="b", ylim=c(800,3700), pch=3)
points(aic[,1], -aic[,4], type="b", pch=1)
points(aic[,1], aic[,2], type="b", pch=2)
plot(aic[,1], -aic[,3], type="b", ylim=c(800,3700), pch=2)
points(aic[,1], -aic[,4], type="b", pch=1)
points(aic[,1], aic[,2], type="b", pch=3)
plot(aic[,1], -aic[,3], type="b", ylim=c(800,3700), pch=2)
points(aic[,1], -aic[,4], type="b", pch=3)
points(aic[,1], aic[,2], type="b", pch=1)
plot(aic[,1], -aic[,3], type="b", ylim=c(800,3700), pch=3)
points(aic[,1], -aic[,4], type="b", pch=2)
points(aic[,1], aic[,2], type="b", pch=1)
plot(aic[,1], -aic[,3], type="b", ylim=c(800,3700), pch=4)
plot(aic[,1], -aic[,3], type="b", ylim=c(800,3700), pch=4)
points(aic[,1], -aic[,4], type="b", pch=2)
points(aic[,1], aic[,2], type="b", pch=1)
plot(aic[,1], -aic[,3], type="b", ylim=c(800,3700), pch=4)
points(aic[,1], -aic[,4], type="b", pch=3)
points(aic[,1], aic[,2], type="b", pch=1)
plot(aic[,1], -aic[,3], type="b", ylim=c(800,3700), pch=4)
points(aic[,1], -aic[,4], type="b", pch=2)
points(aic[,1], aic[,2], type="b", pch=1)
plot(aic[,1], -aic[,3], type="b", ylim=c(800,3700), pch=4, lwd=3)
points(aic[,1], -aic[,4], type="b", pch=2, lwd=3)
points(aic[,1], aic[,2], type="b", pch=1, lwd=3)
plot(aic[,1]+1, -aic[,3], type="b", ylim=c(800,3700), pch=4, lwd=3, xlab='Number of components')
points(aic[,1], -aic[,4], type="b", pch=2, lwd=3)
points(aic[,1], aic[,2], type="b", pch=1, lwd=3)
aic <- read.table('ML_AIC_BIC.txt', header=TRUE)
aic <- aic[-1,]
plot(aic[,1]+1, -aic[,3], type="b", ylim=c(800,3700), pch=4, lwd=3, xlab='Number of components')
points(aic[,1]+1, -aic[,4], type="b", pch=2, lwd=3)
points(aic[,1]+1, aic[,2], type="b", pch=1, lwd=3)
plot(aic[,1]+1, -aic[,3], type="b", ylim=c(800,3700), pch=4, lwd=3, xlab='Number of components',ylab="")
points(aic[,1]+1, -aic[,4], type="b", pch=2, lwd=3)
points(aic[,1]+1, aic[,2], type="b", pch=1, lwd=3)
plot(aic[,1]+1, aic[,2], type="b", ylim=c(800,3700), pch=1, lwd=3, xlab='Number of components',ylab="")
points(aic[,1]+1, -aic[,4], type="b", pch=2, lwd=3)
points(aic[,1]+1, -aic[,3], type="b", pch=4, lwd=3)
plot(aic[,1]+1, aic[,2], type="b", ylim=c(800,3700), pch=1, lwd=3, xlab='Number of components',ylab="")
points(aic[,1]+1, -aic[,4], type="b", pch=2, lwd=3)
points(aic[,1]+1, -aic[,3], type="b", pch=4, lwd=3)
legend(10, 2500, legend=c("Max Like", "AIC", "BIC"), pch=c(1,2,4), cex=0.8)
plot(aic[,1]+1, aic[,2], type="b", ylim=c(800,3700), pch=1, lwd=3, xlab='Number of components',ylab="")
points(aic[,1]+1, -aic[,4], type="b", pch=2, lwd=3)
points(aic[,1]+1, -aic[,3], type="b", pch=4, lwd=3)
legend(12, 2750, legend=c("Max Likelihood", "AIC", "BIC"), pch=c(1,2,4), cex=0.8)
plot(aic[,1]+1, aic[,2], type="b", ylim=c(800,3700), pch=1, lwd=3, xlab='Number of components',ylab="")
points(aic[,1]+1, -aic[,4], type="b", pch=2, lwd=3)
points(aic[,1]+1, -aic[,3], type="b", pch=4, lwd=3)
legend(11.5, 2750, legend=c("Max Likelihood", "AIC", "BIC"), pch=c(1,2,4), cex=0.8)
png("aic.png", weight=880, height=880)
plot(aic[,1]+1, aic[,2], type="b", ylim=c(800,3700), pch=1, lwd=3, xlab='Number of components',ylab="")
points(aic[,1]+1, -aic[,4], type="b", pch=2, lwd=3)
points(aic[,1]+1, -aic[,3], type="b", pch=4, lwd=3)
legend(11.5, 2750, legend=c("Max Likelihood", "AIC", "BIC"), pch=c(1,2,4), cex=0.8)
dev.off()
png("aic.png", width=880, height=880)
plot(aic[,1]+1, aic[,2], type="b", ylim=c(800,3700), pch=1, lwd=3, xlab='Number of components',ylab="")
points(aic[,1]+1, -aic[,4], type="b", pch=2, lwd=3)
points(aic[,1]+1, -aic[,3], type="b", pch=4, lwd=3)
legend(11.5, 2750, legend=c("Max Likelihood", "AIC", "BIC"), pch=c(1,2,4), cex=0.8)
dev.off()
png("aic.png", width=880, height=880)
plot(aic[,1]+1, aic[,2], type="b", ylim=c(800,3700), pch=1, lwd=3, cex=5, xlab='Number of components',ylab="")
points(aic[,1]+1, -aic[,4], type="b", pch=2, lwd=3)
points(aic[,1]+1, -aic[,3], type="b", pch=4, lwd=3)
legend(11.5, 2750, legend=c("Max Likelihood", "AIC", "BIC"), pch=c(1,2,4), cex=0.8)
dev.off()
png("aic.png", width=880, height=880)
plot(aic[,1]+1, aic[,2], type="b", ylim=c(800,3700), pch=1, lwd=3, cex=4, xlab='Number of components',ylab="",cex.lab=4, cex.axis=4)
points(aic[,1]+1, -aic[,4], type="b", pch=2, lwd=3, cex=4)
points(aic[,1]+1, -aic[,3], type="b", pch=4, lwd=3, cex=4)
legend(11.5, 2750, legend=c("Max Likelihood", "AIC", "BIC"), pch=c(1,2,4), cex=4)
dev.off()
png("aic.png", width=880, height=880)
plot(aic[,1]+1, aic[,2], type="b", ylim=c(800,3700), pch=1, lwd=3, cex=4, xlab='Number of components',ylab="",cex.lab=2, cex.axis=2)
points(aic[,1]+1, -aic[,4], type="b", pch=2, lwd=3, cex=4)
points(aic[,1]+1, -aic[,3], type="b", pch=4, lwd=3, cex=4)
legend(11.5, 2750, legend=c("Max Likelihood", "AIC", "BIC"), pch=c(1,2,4), cex=2)
dev.off()
png("aic.png", width=880, height=880)
plot(aic[,1]+1, aic[,2], type="b", ylim=c(800,3700), pch=1, lwd=3, cex=4, xlab='Number of components',ylab="",cex.lab=2, cex.axis=2)
points(aic[,1]+1, -aic[,4], type="b", pch=2, lwd=3, cex=4)
points(aic[,1]+1, -aic[,3], type="b", pch=4, lwd=3, cex=4)
legend(11.5, 2750, legend=c("Max Likelihood", "-AIC", "-BIC"), pch=c(1,2,4), cex=2)
dev.off()
best.fit6 <- c(33.4922778,178.7986363,99.6374025,1.7764093,11.0413781,36.6465465,192.4226231,98.7433891,0.6958162,4.0928611,0.9438338,39.4714647,174.2871702,97.4884604,0.5068079,23.8376086,0.9617357,25.9833269,189.4876882,98.9307028,0.6716782,29.9954276,1.0303856,20.5144112,192.6262481,100.8967307,0.4479781,29.9997800,0.9084992,38.5415003,193.9679828,96.2248270,0.5300646,29.4606345,0.8219343,-1.8258571)
best.fit7 <- c(33.49064057,178.81823825,99.67297463,3.50675328,17.19864656,36.58717423,192.41395273,98.75807514,1.19973692,19.54102740,1.03018329,39.50470556,174.23329840,97.49335940,1.15731316,25.80417902,0.76932166,25.97954381,189.43264352,98.91216652,1.25347861,29.95355119,1.08576993,20.48780801,192.69552175,100.84900542,1.09716115,29.92893875,0.54914802,38.57085531,193.95975705,96.14788591,0.93637276,22.81280311,0.97947835,47.51026301,183.39151518,105.63535392,1.46679836,0.09135961,1.18440199,-1.11245379)
param6 <- best.fit6
param7 <- best.fit7
k <- 6
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param6, param2, clust, quad)
k <- 7
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param7, param2, clust, quad)
param2profile(param6)
param2profile(param7)
clust
map.fit <- c(
20.3939191, 192.7140689, 100.8164129,   0.5627960,   3.5969487,
26.0063255, 189.3491222,  98.8683466,   1.1229594,   2.5022460,  -0.1049331,
33.4557350, 178.8033589,  99.7013227,   1.0512387,   2.4276491,   0.2072407,
36.6670298, 192.3357233,  98.7542129,   0.7779691,   2.9993584,   0.3034333,
38.5763958, 193.8873048,  96.1751606,   0.7556134,   2.1563532,  -0.1187168,
39.4690908, 174.2191848,  97.4405423,   0.8705782,   3.1902658,  -0.2794959,
-2.0696242)
param6 <- map.fit
k <- 6
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param6, param2, clust, quad)
k <- 7
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0)
AIC.BIC(param7, param2, clust, quad)
param2profile(param6)
iter=3
i <- 6
param <- param6
print(i)
k <- i
v <- 5 # x,y,z,re,n
param2 <-c(k+1, rep(c(einasto.model,v),k),const.model,0);
for(j in 1:iter){
print(j)
ocf <- optim(param, model.lik, param2=param2, model=mixture.model, clust=clust, quad=quad);
param <- ocf$par;
-model.lik(param, param2, mixture.model, clust, quad)
# Further model refinement. Freezing
param <- mask.freeze(param, param2, mask.adjust_positions(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
param <- mask.freeze(param, param2, mask.adjust_radii(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
param <- mask.freeze(param, param2, mask.adjust_sersic(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
param <- mask.freeze(param, param2, mask.adjust_mix(k,v), clust, quad)
-model.lik(param, param2, mixture.model, clust, quad)
ocf <- optim(param, model.lik, param2=param2, model=mixture.model, clust=clust, quad=quad);
param <- ocf$par;
-model.lik(param, param2, mixture.model, clust, quad)
param2profile(param)
AIC.BIC(param, param2, clust, quad)
}
AIC.BIC(param, param2, clust, quad)
aic <- read.table('ML_AIC_BIC.txt', header=TRUE)
aic <- aic[-1,]
png("aic.png", width=880, height=660)
par(mar=c(6,6,0,0))
plot(aic[,1]+1, aic[,2], type="b", ylim=c(800,3700), pch=1, lwd=3, cex=4, xlab='Number of components',ylab="",cex.lab=2, cex.axis=2)
points(aic[,1]+1, -aic[,4], type="b", pch=2, lwd=3, cex=4)
points(aic[,1]+1, -aic[,3], type="b", pch=4, lwd=3, cex=4)
legend(11.5, 2750, legend=c("Max Likelihood", "-AIC", "-BIC"), pch=c(1,2,4), cex=2)
dev.off()
aic
png("aic.png", width=880, height=660)
par(mar=c(6,6,0,0))
plot(aic[,1]+1, aic[,2], type="b", ylim=c(800,3700), pch=1, lwd=3, cex=4, xlab='Number of components',ylab="",cex.lab=2, cex.axis=2)
points(aic[,1]+1, -aic[,4], type="b", pch=2, lwd=3, cex=4)
points(aic[,1]+1, -aic[,3], type="b", pch=4, lwd=3, cex=4)
legend(11.5, 2750, legend=c("Max Likelihood", "-BIC", "-AIC"), pch=c(1,2,4), cex=2)
dev.off()
png("aic.png", width=880, height=660)
par(mar=c(6,6,0,0))
plot(aic[,1]+1, aic[,2], type="b", ylim=c(800,3700), pch=1, lwd=3, cex=4, xlab='Number of components',ylab="",cex.lab=2, cex.axis=2)
points(aic[,1]+1, -aic[,4], type="b", pch=2, lwd=3, cex=4)
points(aic[,1]+1, -aic[,3], type="b", pch=4, lwd=3, cex=4)
legend(11.5, 2750, legend=c("Max Likelihood", "-AIC", "-BIC"), pch=c(1,4,2), cex=2)
dev.off()
png("aic.png", width=880, height=660)
par(mar=c(6,6,0,0))
plot(aic[,1]+1, aic[,2], type="b", ylim=c(800,3700), pch=1, lwd=3, cex=4, xlab='Number of components',ylab="",cex.lab=2, cex.axis=2)
points(aic[,1]+1, -aic[,4], type="b", pch=2, lwd=3, cex=4)
points(aic[,1]+1, -aic[,3], type="b", pch=4, lwd=3, cex=4)
legend(11.5, 2750, legend=c("Max Likelihood", "-AIC", "-BIC"), pch=c(1,4,2), cex=2)
dev.off()
